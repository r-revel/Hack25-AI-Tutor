@inject NavigationManager Nav

<div class="auth-backdrop">
    <div class="auth-modal">
        <div class="auth-tabs">
            <button type="button"
                    class="auth-tab @(isLoginMode ? "auth-tab--active" : "")"
                    @onclick="@(() => SwitchMode(true))">
                Вход
            </button>
            <button type="button"
                    class="auth-tab @(!isLoginMode ? "auth-tab--active" : "")"
                    @onclick="@(() => SwitchMode(false))">
                Регистрация
            </button>
        </div>

        <div class="auth-body">
            <h2 class="auth-title">@((isLoginMode ? "Вход" : "Регистрация"))</h2>

            @if (!string.IsNullOrEmpty(errorMessage))
            {
                <div class="auth-alert">@errorMessage</div>
            }

            @if (isLoginMode)
            {
                <form method="post" action="/auth/login">
                    <input type="hidden" name="ReturnUrl" value="/" />

                    <div class="auth-field">
                        <label class="auth-label">Username</label>
                        <input name="Username" class="auth-input" required />
                    </div>

                    <div class="auth-field">
                        <label class="auth-label">Пароль</label>
                        <input name="Password" class="auth-input" required type="password" />
                    </div>

                    <div class="auth-field auth-field--horizontal">
                        <input type="checkbox" name="RememberMe" />
                        <label class="auth-label-inline">Запомнить меня</label>
                    </div>

                    <button type="submit" class="auth-button-primary">
                        Войти
                    </button>
                </form>
            }
            else
            {
                <form method="post" action="/auth/register">
                    <div class="auth-field">
                        <label class="auth-label">Username</label>
                        <input name="Username" class="auth-input" required />
                    </div>

                    <div class="auth-field">
                        <label class="auth-label">E-mail</label>
                        <input name="Email" class="auth-input" required type="email" />
                    </div>

                    <div class="auth-field">
                        <label class="auth-label">Пароль</label>
                        <input name="Password" class="auth-input" required type="password" minlength="4" />
                    </div>

                    <div class="auth-field">
                        <label class="auth-label">Повтор пароля</label>
                        <input name="ConfirmPassword" class="auth-input" required type="password" minlength="4" />
                    </div>

                    <button type="submit" class="auth-button-primary">
                        Зарегистрироваться
                    </button>
                </form>
            }
        </div>
    </div>
</div>

@code {
    private bool isLoginMode = true;
    private string? errorMessage;

    private void SwitchMode(bool login)
    {
        isLoginMode = login;
        errorMessage = null;
    }
}
