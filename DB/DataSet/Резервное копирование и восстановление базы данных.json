{
  "title": "Резервное копирование и восстановление базы данных",
  "chapters": [
    {
      "name": "Резервное копирование и восстановление базы данных",
      "content": "Практические руководства Evolution    \n\n # Резервное копирование и восстановление базы данных   Эта статья полезна?          \nС помощью этого руководства вы создадите дамп базы данных PostgreSQL® через pg_dump, а затем восстановите базу с помощью pg_restore.\nВосстановить данные можно только в существующую базу данных.\nЗа раз вы можете восстановить одну базу данных.\nШаги:\n1. Разверните необходимые ресурсы в облаке.\n2. Создайте дамп базы данных.\n3. Восстановите базу данных из дампа.\n\n## Перед началом работы\n1. Зарегистрируйтесь в личном кабинете Cloud.ru.\nЕсли вы уже зарегистрированы, войдите под своей учетной записью.\n2. Сгенерируйте SSH-ключ и загрузите его в облачный каталог.\n\n## 1. Разверните необходимые ресурсы в облаке\n1. Создайте виртуальную машину с ОС Ubuntu 24.04 в том же проекте, зоне доступности и подсети, где будет располагаться кластер Managed PostgreSQL®.\n2. Назначьте виртуальной машине публичный IP-адрес.\n3. Убедитесь, что вы можете подключиться к виртуальной машине по SSH.\n4. Создайте кластер.\n5. Подключитесь к базе данных.\n\n## 2. Создайте дамп базы данных\nВнимание Перенос пользователей через дамп базы данных невозможен.Вы можете создать пользователей через личный кабинет или API.\nНе используйте имена dbadmin, postgres, cnpg__pooler__pgbouncer, streaming_replica, а также имена, начинающиеся на pg_, так как эти имена зарезервированы сервисом Managed PostgreSQL®.\nУтилита pg_dump — встроенный инструмент для создания резервных копий в PostgreSQL®.\nИспользуйте команду:\n```\npg_dump \\   --dbname=<database_name> \\   --file=<dump_file_path> \\   --format=c \\   --inserts \\   --disable-triggers \\   --clean \\   --if-exists \\   --username=<database_user_name> \\   --host=<database_host> \\   --port=<database_port> \\   -O \\   -x \\   -v\n```\n\nГде:\n- <database_name> — имя базы данных.\n- <dump_file_path> — путь до файла дампа.\n- <database_user_name> — имя пользователя базы данных.\n- <database_host> — хост базы данных.\n- <database_port> — порт базы данных.\n\n## 3. Восстановите базу данных из дампа\nУтилита pg_restore восстанавливает данные из резервных копий, которые были созданы с помощью pg_dump.\nВниманиеУ пользователя dbadmin нет прав на CREATE DATABASE, поэтому восстановление можно выполнить только в существующую базу данных.\nВы можете создать базу данных через личный кабинет или API.\n```\npg_restore -O -x \\   --dbname=<database_name> \\   --username=<database_user_name> \\   --host=<database_host> \\   --port=<database_port> \\   --disable-triggers \\   --clean \\   --if-exists \\   <dump_file_path> \\   -v\n```\n\nГде:\n- <database_name> — имя базы данных.\n- <database_user_name> — имя пользователя базы данных.\n- <database_host> — хост базы данных.\n- <database_port> — порт базы данных.\n- <dump_file_path> — путь до файла дампа.\n\n## Результат\nВы создали дамп базы данных PostgreSQL® с помощью утилиты pg_dump, а затем восстановили базу с помощью pg_restore.\n\n  [© 2025 Cloud.ru](https://cloud.ru)",
      "debug": {
        "start_page": 1,
        "end_page": 1
      }
    }
  ]
}